<!DOCTYPE html>
<html lang="fr">
	<head>
		<title>Autonomous Car</title>
		<!-- Leaflet -->
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
		<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

		<!-- Scripts -->
		<script src="scripts.js"></script>

	</head>

	<style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
            width: 100%;
        }
	</style>

	<body>
		<div id="map"></div>
	</body>

	<script>

	// Connecting to ROS
  // -----------------

  var ros = new ROSLIB.Ros({
    url : 'ws://localhost:9090'
  });

  ros.on('connection', function() {
    console.log('Connected to websocket server.');
  });

  ros.on('error', function(error) {
    console.log('Error connecting to websocket server: ', error);
  });

  ros.on('close', function() {
    console.log('Connection to websocket server closed.');
  });


  });

	//===> Global variables
	var map;
	var startPoint = {lat : 39.4783618733, lon : -0.335404928529};
	var endPoint = {lat : 39.48283465, lon : -0.343878495106637};
	var markerPosition = L.marker([39,0]).addTo(map);
	var routeControl;



	//===> Program start (refer to scripts.js)
	mapInit();

	map.on('click', function(e) {
	    var lat = e.latlng.lat;
	    var lon = e.latlng.lng;

	    endPoint.lat = lat;
	    endPoint.lon = lon;
	    startRoad(startPoint,endPoint);
	});

	
 // Subscribing to a Topic
  // ----------------------

  var listener = new ROSLIB.Topic({
    ros : ros,
    name : '/gps',
    messageType : 'sensor_msgs/NavSatFix'
  });

  listener.subscribe(function(message) {
    console.log('Received message on ' + listener.name + ': ' + message.data);
    markerPosition.setLongLat([message.latitude, message.longitude]);
   });

	</script>

</html>

